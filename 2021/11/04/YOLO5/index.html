<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Jacky.C"><meta name="copyright" content="Jacky.C"><meta name="generator" content="Hexo 5.3.0"><meta name="theme" content="hexo-theme-yun"><title>YOLOv5 Training Using Custom Dataset | Jacky's Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false},
      {left: "\\[", right: "\\]", display: true}
    ]
  });
});</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-dark.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/sun.ico"><link rel="mask-icon" href="/sun.ico" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"scnujackychen.github.io","root":"/","title":["Jacky","同学","的","杂货铺"],"version":"1.4.0","mode":"auto","copycode":true,"page":{"isPost":true},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Jacky's Blog" type="application/atom+xml"><meta name="description" content="A tutorial about how to train YOLOv5 model on your own dataset">
<meta property="og:type" content="article">
<meta property="og:title" content="YOLOv5 Training Using Custom Dataset">
<meta property="og:url" content="https://scnujackychen.github.io/2021/11/04/YOLO5/index.html">
<meta property="og:site_name" content="Jacky&#39;s Blog">
<meta property="og:description" content="A tutorial about how to train YOLOv5 model on your own dataset">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/cover.jpg">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/yoyo.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/yolo_output.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/curve.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/file.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/dataset.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/51.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/makesense.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/yaml.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/train_res.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/coco_res.png">
<meta property="og:image" content="https://scnujackychen.github.io/images/YOLO/detect.png">
<meta property="article:published_time" content="2021-11-04T02:25:46.000Z">
<meta property="article:modified_time" content="2021-11-04T07:05:59.605Z">
<meta property="article:author" content="Jacky.C">
<meta property="article:tag" content="YOLO">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://scnujackychen.github.io/images/YOLO/cover.jpg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Jacky.C"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Jacky.C"><span class="site-author-status" title="对知识和技术永葆敬畏之心">😎</span></a><div class="site-author-name"><a href="/about/">Jacky.C</a></div><a class="site-name" href="/about/site.html">Jacky's Blog</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">69</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">70</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="happyboyczq@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/SCNUJackyChen" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/chen-jin-ye-56" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Brief-for-YOLOv5"><span class="toc-number">2.</span> <span class="toc-text">Brief for YOLOv5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#data"><span class="toc-number">3.</span> <span class="toc-text">data</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#data-configuration-%E2%80%93-yaml-file"><span class="toc-number">3.1.</span> <span class="toc-text">data configuration – yaml file</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dataset-organization"><span class="toc-number">3.1.1.</span> <span class="toc-text">dataset organization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-Your-Own-Dataset"><span class="toc-number">3.2.</span> <span class="toc-text">Build Your Own Dataset</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FiftyOne"><span class="toc-number">3.2.1.</span> <span class="toc-text">FiftyOne</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Makesense-ai"><span class="toc-number">3.2.2.</span> <span class="toc-text">Makesense.ai</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Model-Training-and-Testing"><span class="toc-number">4.</span> <span class="toc-text">Model Training and Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#training-details"><span class="toc-number">4.1.</span> <span class="toc-text">training details</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#testing"><span class="toc-number">4.2.</span> <span class="toc-text">testing</span></a></li></ol></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/BFS/" style="font-size: 20px; color: #558abc">BFS</a> <a href="/tags/BPTT/" style="font-size: 12px; color: #999">BPTT</a> <a href="/tags/BST/" style="font-size: 12px; color: #999">BST</a> <a href="/tags/DFS/" style="font-size: 22px; color: #4487c4">DFS</a> <a href="/tags/DP/" style="font-size: 28px; color: #117cde">DP</a> <a href="/tags/GCD/" style="font-size: 12px; color: #999">GCD</a> <a href="/tags/LCP/" style="font-size: 12px; color: #999">LCP</a> <a href="/tags/LIS/" style="font-size: 12px; color: #999">LIS</a> <a href="/tags/Leetcode/" style="font-size: 30px; color: #0078e7">Leetcode</a> <a href="/tags/ML/" style="font-size: 14px; color: #8895a2">ML</a> <a href="/tags/Morris/" style="font-size: 12px; color: #999">Morris</a> <a href="/tags/PCA/" style="font-size: 12px; color: #999">PCA</a> <a href="/tags/RNN/" style="font-size: 12px; color: #999">RNN</a> <a href="/tags/STL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/" style="font-size: 12px; color: #999">STL源码剖析</a> <a href="/tags/Trie/" style="font-size: 12px; color: #999">Trie</a> <a href="/tags/YOLO/" style="font-size: 12px; color: #999">YOLO</a> <a href="/tags/cpp/" style="font-size: 12px; color: #999">cpp</a> <a href="/tags/trie/" style="font-size: 12px; color: #999">trie</a> <a href="/tags/%E4%BA%8C%E5%88%86/" style="font-size: 24px; color: #3383cd">二分</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 12px; color: #999">二叉树</a> <a href="/tags/%E5%89%8D%E5%90%8E%E7%BC%80%E5%88%86%E8%A7%A3/" style="font-size: 16px; color: #7792aa">前后缀分解</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" style="font-size: 26px; color: #227fd6">前缀和</a> <a href="/tags/%E5%8C%BA%E9%97%B4%E5%90%88%E5%B9%B6/" style="font-size: 12px; color: #999">区间合并</a> <a href="/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" style="font-size: 20px; color: #558abc">单调栈</a> <a href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" style="font-size: 14px; color: #8895a2">博弈论</a> <a href="/tags/%E5%93%88%E5%B8%8C/" style="font-size: 18px; color: #668eb3">哈希</a> <a href="/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/" style="font-size: 12px; color: #999">哈希表</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size: 12px; color: #999">图论</a> <a href="/tags/%E5%A0%86/" style="font-size: 14px; color: #8895a2">堆</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 12px; color: #999">字符串</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2DP/" style="font-size: 18px; color: #668eb3">字符串DP</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C/" style="font-size: 16px; color: #7792aa">字符串哈希</a> <a href="/tags/%E5%AF%B9%E9%A1%B6%E6%A0%88/" style="font-size: 12px; color: #999">对顶栈</a> <a href="/tags/%E5%B7%AE%E5%88%86/" style="font-size: 14px; color: #8895a2">差分</a> <a href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" style="font-size: 14px; color: #8895a2">并查集</a> <a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 12px; color: #999">序列化</a> <a href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" style="font-size: 14px; color: #8895a2">快速幂</a> <a href="/tags/%E6%80%9D%E7%BB%B4%E9%A2%98/" style="font-size: 18px; color: #668eb3">思维题</a> <a href="/tags/%E6%89%BE%E8%A7%84%E5%BE%8B/" style="font-size: 14px; color: #8895a2">找规律</a> <a href="/tags/%E6%8A%97%E4%BD%93%E6%A3%80%E6%B5%8B/" style="font-size: 12px; color: #999">抗体检测</a> <a href="/tags/%E6%8E%92%E5%88%97/" style="font-size: 12px; color: #999">排列</a> <a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 12px; color: #999">搜索</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 16px; color: #7792aa">数学</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 14px; color: #8895a2">数据结构</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 14px; color: #8895a2">数论</a> <a href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" style="font-size: 12px; color: #999">斯特林数</a> <a href="/tags/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" style="font-size: 12px; color: #999">时间复杂度</a> <a href="/tags/%E6%9C%80%E5%A4%A7%E7%8B%AC%E7%AB%8B%E9%9B%86/" style="font-size: 12px; color: #999">最大独立集</a> <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" style="font-size: 14px; color: #8895a2">最短路</a> <a href="/tags/%E6%A0%88/" style="font-size: 12px; color: #999">栈</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://scnujackychen.github.io/2021/11/04/YOLO5/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Jacky.C"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Jacky's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">YOLOv5 Training Using Custom Dataset<a class="post-edit-link" href="https://github.com/SCNUJackyChen/SCNUJackyChen.github.io/tree/hexo/source/_posts/YOLO5.md" target="_blank" title="Edit this post" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2021-11-04 10:25:46" itemprop="dateCreated datePublished" datetime="2021-11-04T10:25:46+08:00">2021-11-04</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">1.4k</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/Computer-Vision/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Computer Vision</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/YOLO/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">YOLO</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p><img src="/images/YOLO/cover.jpg" alt="apple" loading="lazy"></p>
<a id="more"></a>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Object detection is a classic task in computer vision application. Human see the world through  their eyes, and the recognition process is completed in our brains. But how can computers simulate such process? </p>
<p>The process we human recognize can be divided into 2 parts: perception and reasoning. A natural idea is to tackle the object detection task by using two seperate models: object location and classification. The representative works are most traditional RCNN based models. Basically such two-stages models must look at the image twice, one for extract the object region and the other for object classification. However, although RCNN based models have got high performance, they share one fatal drawback: <strong>slow</strong>. Low fps becomes the obstacle on our way to implement a real-time object detection system. </p>
<p>Luckily, YOLO was born.</p>
<blockquote>
<p>When I first saw this funny name, I just recalled a kind of toy I played when I was a little boy – yoyo 🤣</p>
</blockquote>
<p><img src="/images/YOLO/yoyo.png" alt="apple" loading="lazy"></p>
<p>As the name says, You Only Look Once, the design idea of YOLO is to convert the  two-stages pipeline into one-stage, treating it as a end-to-end regression problem. Both bboxes and labels are learned via regression model. In inference phase, the output comes out bboxes coordinates and labels at the same time! Intuitively I can feel how fast the reasoning speed such architecture could reach.</p>
<p><img src="/images/YOLO/yolo_output.png" alt="yolov1 output" loading="lazy"></p>
<p>Since <a target="_blank" rel="noopener" href="https://pjreddie.com/yolo/">YOLOv1</a> was introduced in 2016, the father of YOLO Joseph Redmon continued to improve the model architecture and proposed YOLOv2 and v3. But the pity is that this genius guy declared to stop his research on YOLO since the powerful object detection framework had been used in military and privacy application. Therefore, YOLOv4 and v5 and YOLOx were proposed by other researchers.</p>
<p>Today I gonna to talk about the lastest version of YOLO – YOLOv5, mainly focus on how to train it using custom dataset. Since the paper of YOLOv5 has not been published yet, I will not deep in too much details for the design and code implementation of YOLOv5 (maybe will do it in the future).</p>
<p>So, let’s get started!</p>
<h1 id="Brief-for-YOLOv5"><a href="#Brief-for-YOLOv5" class="headerlink" title="Brief for YOLOv5"></a>Brief for YOLOv5</h1><p>The code for YOLOv5 can easily be gained from <a target="_blank" rel="noopener" href="https://github.com/ultralytics/yolov5">Github</a>, with well written document and guidance. The repositorty is still updated at high frequency. After countless iterations, and The original creative idea have now become a sophiscated system. The experiment result given by the author proves the strong performance of YOLOv5.</p>
<p><img src="/images/YOLO/curve.png" alt="YOLOv5 experiment result" loading="lazy"></p>
<p>We can clone the repository to local (All codes are run on <a target="_blank" rel="noopener" href="https://colab.research.google.com/">Colab</a>)</p>
<pre class="language-none"><code class="language-none">!git clone https:&#x2F;&#x2F;github.com&#x2F;ultralytics&#x2F;yolov5  # clone repo
%cd yolov5
%pip install -qr requirements.txt  # install dependencies</code></pre>
<p>Walk into the <code>/yolov5</code> directory and have a look at the file structure.</p>
<p><img src="/images/YOLO/file.png" alt="files" loading="lazy"></p>
<ul>
<li><code>/data</code> diretory is where to put the dataset configuration file, hyperparameters and testing images.</li>
</ul>
<h1 id="data"><a href="#data" class="headerlink" title="data"></a>data</h1><ul>
<li>The <code>yaml</code> files are the dataset configuration files (will explain in the following)</li>
<li><code>/image</code> diretory is where to put the testing images</li>
<li><code>/script</code> includes the <code>.sh</code> scripts to run the code</li>
<li><code>/hyps</code> is where to set the hyperparameters</li>
</ul>
<h2 id="data-configuration-–-yaml-file"><a href="#data-configuration-–-yaml-file" class="headerlink" title="data configuration – yaml file"></a>data configuration – yaml file</h2><p>When we want to train our model on a certain dataset, the programme will first take a look at this directory and search for the dataset configuration file. </p>
<p>Like a simple json file, the syntax of yaml is straightforward: it has only key and value. Let’s take a look at the official <code>coco128.yaml</code>.</p>
<pre class="language-none"><code class="language-none">path: ..&#x2F;datasets&#x2F;coco128  # dataset root dir
train: images&#x2F;train2017  # train images (relative to &#39;path&#39;) 128 images
val: images&#x2F;train2017  # val images (relative to &#39;path&#39;) 128 images
test:  # test images (optional)

# Classes
nc: 80  # number of classes
names: [&#39;person&#39;, &#39;bicycle&#39;, &#39;car&#39;, &#39;motorcycle&#39;, &#39;airplane&#39;, &#39;bus&#39;, &#39;train&#39;, &#39;truck&#39;, &#39;boat&#39;, &#39;traffic light&#39;,
        &#39;fire hydrant&#39;, &#39;stop sign&#39;, &#39;parking meter&#39;, &#39;bench&#39;, &#39;bird&#39;, &#39;cat&#39;, &#39;dog&#39;, &#39;horse&#39;, &#39;sheep&#39;, &#39;cow&#39;,
        &#39;elephant&#39;, &#39;bear&#39;, &#39;zebra&#39;, &#39;giraffe&#39;, &#39;backpack&#39;, &#39;umbrella&#39;, &#39;handbag&#39;, &#39;tie&#39;, &#39;suitcase&#39;, &#39;frisbee&#39;,
        &#39;skis&#39;, &#39;snowboard&#39;, &#39;sports ball&#39;, &#39;kite&#39;, &#39;baseball bat&#39;, &#39;baseball glove&#39;, &#39;skateboard&#39;, &#39;surfboard&#39;,
        &#39;tennis racket&#39;, &#39;bottle&#39;, &#39;wine glass&#39;, &#39;cup&#39;, &#39;fork&#39;, &#39;knife&#39;, &#39;spoon&#39;, &#39;bowl&#39;, &#39;banana&#39;, &#39;apple&#39;,
        &#39;sandwich&#39;, &#39;orange&#39;, &#39;broccoli&#39;, &#39;carrot&#39;, &#39;hot dog&#39;, &#39;pizza&#39;, &#39;donut&#39;, &#39;cake&#39;, &#39;chair&#39;, &#39;couch&#39;,
        &#39;potted plant&#39;, &#39;bed&#39;, &#39;dining table&#39;, &#39;toilet&#39;, &#39;tv&#39;, &#39;laptop&#39;, &#39;mouse&#39;, &#39;remote&#39;, &#39;keyboard&#39;, &#39;cell phone&#39;,
        &#39;microwave&#39;, &#39;oven&#39;, &#39;toaster&#39;, &#39;sink&#39;, &#39;refrigerator&#39;, &#39;book&#39;, &#39;clock&#39;, &#39;vase&#39;, &#39;scissors&#39;, &#39;teddy bear&#39;,
        &#39;hair drier&#39;, &#39;toothbrush&#39;]  # class names


# Download script&#x2F;URL (optional)
download: https:&#x2F;&#x2F;github.com&#x2F;ultralytics&#x2F;yolov5&#x2F;releases&#x2F;download&#x2F;v1.0&#x2F;coco128.zip</code></pre>
<p>After  parsing this <code>yaml</code> file, if the value of <code>download</code> is not empty, the programme will first download the dataset from the link. </p>
<p>Train, val, test path should be defined in this file, so programme can know where stores the dataset.</p>
<h3 id="dataset-organization"><a href="#dataset-organization" class="headerlink" title="dataset organization"></a>dataset organization</h3><p>Generally, the dataset is organized as the following structure.</p>
<p><img src="/images/YOLO/dataset.png" alt="dataset organization" loading="lazy"></p>
<p><code>images/train2017</code> includes all the images for training, while <code>labels/train2017</code> is where the labels are stored.</p>
<h2 id="Build-Your-Own-Dataset"><a href="#Build-Your-Own-Dataset" class="headerlink" title="Build Your Own Dataset"></a>Build Your Own Dataset</h2><p>In many cases, we need to build dataset by ourselves and train our YOLO on it. This part I will introduce two ways to make it: open dataset managment tool <strong>FiftyOne</strong>, online labelling tool <strong>makesense.ai</strong>.</p>
<h3 id="FiftyOne"><a href="#FiftyOne" class="headerlink" title="FiftyOne"></a>FiftyOne</h3><p><a target="_blank" rel="noopener" href="https://github.com/voxel51/fiftyone">FiftyOne</a> is an open-source tool to build high quality datasets. Install the python package first.</p>
<pre class="language-none"><code class="language-none">!pip install fiftyone</code></pre>
<p>We can build our datasets by extracting samples from big public open datasets and combines them together.</p>
<p>For example: </p>
<pre class="language-none"><code class="language-none">import fiftyone as fo
import fiftyone.zoo as foz
dataset &#x3D; foz.load_zoo_dataset(
    &quot;open-images-v6&quot;, 
    split&#x3D;&quot;train&quot;, 
    label_types&#x3D;[&quot;detections&quot;, &quot;classifications&quot;], 
    classes &#x3D; [&#39;Apple&#39;, &#39;Banana&#39;, &#39;Carrot&#39;],
    max_samples&#x3D;3000,
    seed&#x3D;51,
    shuffle&#x3D;True,
    dataset_name&#x3D;&quot;food_train&quot;,
)</code></pre>
<p>We collect 3000 training images includes [‘Apple’, ‘Banana’, ‘Carrot’] from <code>open-images-v6</code> dataset. Building the validation dataset is similar.</p>
<pre class="language-none"><code class="language-none">session &#x3D; fo.launch_app(dataset)</code></pre>
<ul>
<li>visualization of the dataset<br><img src="/images/YOLO/51.png" alt="visualization" loading="lazy"></li>
</ul>
<h3 id="Makesense-ai"><a href="#Makesense-ai" class="headerlink" title="Makesense.ai"></a>Makesense.ai</h3><p>If we are not satisfied with public dataset, then we should label the image by ourselves.<br>Online image labelling tool <a target="_blank" rel="noopener" href="https://www.makesense.ai/">makesense.ai</a> would be a good choice.</p>
<p><img src="/images/YOLO/makesense.png" alt="makesense.ai" loading="lazy"></p>
<p>After labelling, export yolo format file by clicking <code>Actions -&gt; Export Annotations</code>.</p>
<h1 id="Model-Training-and-Testing"><a href="#Model-Training-and-Testing" class="headerlink" title="Model Training and Testing"></a>Model Training and Testing</h1><p>After building custom dataset, we should write our own <code>yaml</code> file.</p>
<pre class="language-none"><code class="language-none">path: ..&#x2F;datasets&#x2F;mydataset  # dataset root dir
train: images&#x2F;train  # train images (relative to &#39;path&#39;) 128 images
val: images&#x2F;val  # val images (relative to &#39;path&#39;) 128 images

nc: 3
names: [&#39;Apple&#39;, &#39;Banana&#39;, &#39;Carrot&#39;]
</code></pre>
<p><img src="/images/YOLO/yaml.png" alt="yaml location" loading="lazy"></p>
<p>After properly set the <code>yaml</code> file and put it inside <code>/data</code>, run the following code to start our YOLO training!</p>
<pre class="language-none"><code class="language-none">!python train.py --img 640 --batch 20 --epochs 10 --data coco128.yaml --weights yolov5s.pt --cache</code></pre>
<p>Explanation for each parameters:</p>
<ul>
<li><code>--img</code>: image size</li>
<li><code>--batch</code>: batch size</li>
<li><code>--epochs</code>: epoch number</li>
<li><code>--data</code>: the location of dataset configuration file</li>
<li><code>--weights</code>: the location of model weight</li>
<li><code>--cache</code>: load all dataset into RAM</li>
</ul>
<h2 id="training-details"><a href="#training-details" class="headerlink" title="training details"></a>training details</h2><p>We can go to <code>runs/train/exp</code> to see more details about the training.</p>
<p>The details of each trial are saved in <code>/run/train/exp</code>, the author already implement the visualization for training results, including curve, confusion matrix, sample snapshot etc.</p>
<p><img src="/images/YOLO/train_res.png" alt="train result" loading="lazy"><br><img src="/images/YOLO/coco_res.png" alt="coco" loading="lazy"></p>
<h2 id="testing"><a href="#testing" class="headerlink" title="testing"></a>testing</h2><pre class="language-none"><code class="language-none">!python detect.py --weights &#x2F;content&#x2F;yolov5&#x2F;runs&#x2F;train&#x2F;exp&#x2F;weights&#x2F;best.pt --img 640 --conf 0.2 --source data&#x2F;images&#x2F;</code></pre>
<p>Explanation of parameters:</p>
<ul>
<li><code>--weights</code>: model weights, we can use the best model we trained</li>
<li><code>--conf</code>: confidence score threshold</li>
<li><code>--source</code>: testing images path</li>
</ul>
<p>If everything goes smoothly, we can walk into <code>/runs/detect/exp</code> to have a look.</p>
<p><img src="/images/YOLO/detect.png" alt="detection" loading="lazy"></p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Jacky.C</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://scnujackychen.github.io/2021/11/04/YOLO5/" title="YOLOv5 Training Using Custom Dataset">https://scnujackychen.github.io/2021/11/04/YOLO5/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/11/26/BPTT/" rel="prev" title="Backpropagation Through Time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Backpropagation Through Time</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/10/11/LC-weekly-contest-262/" rel="next" title="LC weekly contest 262"><span class="post-nav-text">LC weekly contest 262</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>点击按钮跳转 GitHub Issues 评论。</span><br><span>若没有本文 Issue，您可以使用 Comment 模版新建。</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/SCNUJackyChen/SCNUJackyChen.github.io/issues?q=is:issue+YOLOv5 Training Using Custom Dataset">GitHub Issues</a><a class="hty-button hty-button--raised" id="github-discussions" target="_blank" rel="noopener" href="https://github.com/SCNUJackyChen/SCNUJackyChen.github.io/discussions/new">GitHub Discussions</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">粤ICP备20015588号</a></div><div class="copyright"><span>&copy; 2021 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Jacky.C</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.3.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.4.0</span></div><div class="live_time"><span>本博客已快乐地运行</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-01-27T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div><div class="aplayer no-destroy" id="aplayer" data-id="472732356" data-server="netease" data-type="playlist" data-fixed="true" data-theme="#0078E7" data-loop="all" data-order="list" data-preload="auto" data-volume="0.7" data-mutex data-lrctype="0" data-listmaxheight="340px" data-storagename="metingjs"></div></div></body></html>